{% extends 'base.html' %}
{% load static %}

{% block page %}
<section class="grow basis-full mx-4 mt-5 sm:mt-6 md:mx-5 md:mt-8 lg:mx-6 lg:mt-10 2xl:mx-8 2xl:mt-12">
    <form id="create-form" method="post" action="{{ action }}" class="mx-0 md:mx-auto rounded-md lg:rounded-lg p-4 md:p-8 lg:p-12 xl:p-16 w-full md:w-4/5 lg:w-2/3 xl:w-1/2 space-y-4 lg:space-y-6 shadow-md md:shadow-lg lg:shadow-xl bg-slate-100 dark:bg-slate-700 dark:shadow-violet-800">
        <h2 class="text-center">New {{ view.model.__name__ }}</h2>
        {% csrf_token %}
        {% for field in form %}
        <div class="fieldWrapper">
            {% if field.label | lower == "color" %}
                {{ field.errors }}
                {{ field.label_tag }}
                <div class="w-full space-y-1" x-data="{ fieldId: '{{ field.id_for_label }}' }">
                    {{ field }}
                    <div class="grid w-full grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8 2xl:grid-cols-10 gap-1 md:gap-2 xl:gap-4">
                        {% for name, color in color_choices.items %}
                        <button class="bg-{{ name }} h-6 px-3 flex items-center justify-center border border-slate-300 dark:border-slate-600 hover:ring-2 hover:ring-blue-800 dark:hover:ring-violet-600 active:translate-x-0.5 active:translate-y-0.5" @click="document.getElementById(fieldId).value = '{{ color.primary_color }}'">
                            <span class="text-xs" x-init="() => {$el.classList.add(setTextColor('{{ color.primary_color }}'))}">{{ color.display_name }}</span>
                        </button>
                        {% endfor %}
                    </div>
                </div>
                {% if field.help_text %}
                <p class="help" id="{{ field.auto_id }}_helptext">{{ field.help_text | safe }}</p>
                {% endif %}
            {% else %}
            {{ field.as_field_group }}
            {% endif %}
        </div>
        {% endfor %}
        {% if form.errors %}
        <div>
            <p class="text-red-500 dark:text-red-600 text-sm md:text-base">Please correct the following errors:</p>
            <ul class="errorlist">
                {% for field, error_list in form.errors.items %}
                    {% for error in error_list %}
                    <li>{{ field }}: {{ error }}</li>
                    {% endfor %}
                {% endfor %}
            </ul>
        </div>
        {% endif %}
        <div class="pt-3">
            <button type="submit" class="ml-auto btn primary">Submit</button>
        </div>
    </form>
</section>
<script src="{% static 'js/form.js' %}"></script>
{% endblock %}